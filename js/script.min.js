"use strict";const LAPTOP_WIDTH_MEDIA_QUERY="(min-width: 1280px)",MODAL_ANIMATION_DURATION=400,FormEvents={SUBMIT_START:"formSubmitStart",SUBMIT_END:"formSubmitEnd"},KeyCode=Object.freeze({LEFT_ARROW:"ArrowLeft",RIGHT_ARROW:"ArrowRight",DOWN_ARROW:"ArrowDown",BACKSPACE:"Backspace"}),MONTHS_NAMES=["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"];function lockPageScroll(){document.querySelector(".simplebar-content-wrapper").classList.add("scroll-lock")}function unlockPageScroll(){document.querySelector(".simplebar-content-wrapper").classList.remove("scroll-lock")}function createElementByString(e){const t=document.createElement("div");return t.innerHTML=e,t.firstElementChild}function isDownArrowEvent(e){return e.code===KeyCode.DOWN_ARROW}function isLeftArrowEvent(e){return e.code===KeyCode.LEFT_ARROW}function isRightArrowEvent(e){return e.code===KeyCode.RIGHT_ARROW}function isBackspaceEvent(e){return e.code===KeyCode.BACKSPACE}function debounce(e){var t=this;let i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;return function(){for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];clearTimeout(i),i=setTimeout((()=>e.apply(t,r)),o)}}function throttleAndDebounce(e,t){let i,o=0;return function(){for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];const l=(new Date).getTime();l-o>=t&&(o=l,e.apply(this,r)),i&&clearTimeout(i),i=setTimeout((()=>{e.apply(this,r)}),t)}}function getPaginationButtonCreator(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Слайд";return(t,i)=>`\n    <button class='${i}' type='button'>\n      <span class='visually-hidden'>${e} ${t+1}.</span>\n    </button>\n  `}function initFormResending(e,t){function i(){e.removeListener(FormEvents.SUBMIT_START,i),e.addListener(FormEvents.SUBMIT_END,o),t.button.disabled=!0,t.button.classList.add("button--pending")}function o(){e.removeListener(FormEvents.SUBMIT_END,o),t.close()}t.button.addEventListener("click",(t=>{t.preventDefault(),e.addListener(FormEvents.SUBMIT_START,i),e.formElement.requestSubmit()}))}async function sendData(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:()=>{},s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:()=>{};try{const o=await fetch(e,{method:"POST",body:t});if(!o.ok){const e=await o.text();throw new Error(`${o.status} – ${o.statusText}: ${e}`)}i(await o.json())}catch(e){console.error(e.message),o()}finally{s()}}class PubSub{constructor(){this.listeners={}}addListener(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}removeListener(e,t){this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter((e=>e!==t)))}emit(e,t){this.listeners[e]&&this.listeners[e].forEach((e=>e(t)))}}class Modal{constructor(e){let{onOpenerClick:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.modalElement=e,this.name=e?.dataset.modal,this.initOpeners(),this.modalElement.addEventListener("close",(()=>this.onModalClose())),this.onOpenerClick=t,this.modalElement.addEventListener("click",(e=>{e.target!==this.modalElement&&!e.target.closest("[data-modal-close-button]")&&e.target.closest(".modal__inner")||(e.preventDefault(),this.close())})),document.body.contains(this.modalElement)||document.body.append(this.modalElement)}initOpener=e=>{e.addEventListener("click",(t=>{t.preventDefault(),e.dataset.modalOpener===this.name&&(this.onOpenerClick&&this.onOpenerClick(t),this.open())}))};initOpeners=()=>{document.querySelectorAll(`[data-modal-opener="${this.name}"]`).forEach(this.initOpener)};open=()=>{this.modalElement.showModal()};close=()=>{this.modalElement.close()};onModalClose=()=>{setTimeout((()=>{this.modalElement.classList.contains("modal--with_alert")&&(this.modalElement.remove(),this.modalElement=null)}),400)}}class Alert extends Modal{constructor(e){let{heading:t,button:i,icon:o}=e;const s=Alert.createElement({heading:t,button:i,icon:o});document.body.append(s),super(s),this.button=s.querySelector(".alert__button")}static createElement(e){let{heading:t,button:i,icon:o}=e;return createElementByString(`\n      <dialog class="modal modal--default modal--with_alert">\n        <div class="modal__inner">\n          <button class="modal__button modal__button--close" type="button" data-modal-close-button>\n            <span class="visually-hidden">Закрыть</span>\n          </button>\n          <section class="alert modal__alert ${o&&"alert--with-icon"}">\n            <h2 class="alert__heading">${t}</h2>\n            <button class="alert__button button button--solid-primary ${i.classes||""}" ${!i.text&&"data-modal-close-button"}>\n              <span class="button__inner">\n                <span class="button__text">${i.text||"Закрыть"}</span>\n              </span>\n            </button>\n          </section>\n        </div>\n      </dialog>\n    `)}}class FormValidator{constructor(e){this.formElement=e,this.deliveryCompanyElement=this.formElement.querySelector(".checkout-form__delivery-company"),this.deliveryMethodElement=this.formElement.querySelector(".checkout-form__delivery-method"),this.addCustomErrorMessages(),this.init()}addCustomErrorMessages=()=>{const e=this.formElement.querySelector('[data-name="name"]'),t=this.formElement.querySelector('[data-name="surname"]'),i=this.formElement.querySelector('[data-name="address"]'),o=this.formElement.querySelector('[data-name="phone"]'),s=this.formElement.querySelector('[data-name="email"]'),r=this.formElement.querySelector('[data-name="message"]'),n=this.formElement.querySelector('[data-name="region"]'),l=this.formElement.querySelector(".subscription-form__field-control");l&&(l.closest(".subscription-form__field").classList.add("pristine-item"),l.dataset.pristineRequiredMessage="Заполните это поле",l.dataset.pristineEmailMessage="Email введен неправильно"),e&&(e.closest(".text-field").classList.add("pristine-item"),e.dataset.pristinePattern="/^[a-zа-яЁё -]+$/i",e.dataset.pristineRequiredMessage="Заполните это поле.",e.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),t&&(t.closest(".text-field").classList.add("pristine-item"),t.dataset.pristinePattern="/^[a-zа-яЁё -]+$/i",t.dataset.pristineRequiredMessage="Заполните это поле.",t.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),i&&(i.closest(".text-field").classList.add("pristine-item"),i.dataset.pristineRequiredMessage="Заполните это поле."),o&&(o.closest(".text-field").classList.add("pristine-item"),o.dataset.pristineRequiredMessage="Заполните это поле."),s&&(s.closest(".text-field").classList.add("pristine-item"),s.dataset.pristineRequiredMessage="Заполните это поле.",s.dataset.pristineEmailMessage="Введите корректный e-mail адрес."),r&&(r.closest(".text-area").classList.add("pristine-item"),r.dataset.pristineRequiredMessage="Заполните это поле."),n&&(n.closest(".text-field").classList.add("pristine-item"),n.dataset.pristineRequiredMessage="Заполните это поле.")};resetRadiobuttonsGroupValidation(e){e.querySelector(".pristine-item__error-text")?.remove(),e.classList.remove("pristine-item--invalid"),e.classList.remove("shake")}validateRadiobuttonsGroup(e){const t=e.classList.contains("checkout-form__delivery-method"),i=this.deliveryCompanyElement.querySelector(".radio-button__control:checked")?.value;if(t&&"PICKUP"===i)return!0;const o=Array.from(e.querySelectorAll(".radio-button__control, .delivery-methods__control"));if(!o.length)return!0;const s=o.some((e=>e.checked));return s?this.resetRadiobuttonsGroupValidation(e):(e.querySelector(".pristine-item__error-text")?.remove(),e.classList.add("pristine-item--invalid"),e.insertAdjacentHTML("beforeend",'<p class="pristine-item__error-text">Выберите один из вариантов.</p>')),s}validate=()=>{if(this.formElement.classList.contains("checkout-form")){const e=this.validateRadiobuttonsGroup(this.deliveryCompanyElement),t=this.validateRadiobuttonsGroup(this.deliveryMethodElement);return this.pristine.validate()&&e&&t}return this.pristine.validate()};reset=()=>{this.pristine.reset(),this.formElement.querySelectorAll(".shake").forEach((e=>e.classList.remove("shake"))),this.formElement.classList.contains("checkout-form")&&(this.resetRadiobuttonsGroupValidation(this.deliveryCompanyElement),this.resetRadiobuttonsGroupValidation(this.deliveryMethodElement))};onCheckoutFormChange=e=>{e.target.closest(".checkout-form__delivery-company")?(this.resetRadiobuttonsGroupValidation(this.deliveryCompanyElement),"PICKUP"===e.target.value&&this.resetRadiobuttonsGroupValidation(this.deliveryMethodElement)):e.target.closest(".checkout-form__delivery-method")&&this.resetRadiobuttonsGroupValidation(this.deliveryMethodElement)};init=()=>{this.pristine=new Pristine(this.formElement,{classTo:"pristine-item",errorClass:"pristine-item--invalid",errorTextParent:"pristine-item",errorTextTag:"p",errorTextClass:"pristine-item__error-text"}),this.formElement.classList.contains("checkout-form")&&this.formElement.addEventListener("change",this.onCheckoutFormChange)}}class Form extends PubSub{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{resetAfterSubmit:!0};super(),this.formElement=e,this.textFieldControlElements=this.formElement.querySelectorAll(".text-field__control, .simple-form__control, .text-area__control"),this.actionUrl=this.formElement.action,this.submitButtonElement=this.formElement.querySelector("[data-submit-button]"),this.validator=new FormValidator(this.formElement),this.siteHeaderElement=document.querySelector(".page__site-header"),this.successHandler=null,this.errorHandler=null,this.resetAfterSubmit=t.resetAfterSubmit,this.init()}setHandlers=(e,t)=>{this.successHandler=e,this.errorHandler=t};init=()=>{this.formElement.addEventListener("submit",(e=>{e.preventDefault();if(this.validator.validate()){this.emit(FormEvents.SUBMIT_START),this.submitButtonElement.disabled=!0,this.submitButtonElement.classList.add("button--pending");const t=new FormData(e.target);sendData(this.actionUrl,t,(e=>{this.successHandler(e),this.resetAfterSubmit&&this.formElement.reset()}),(e=>{this.errorHandler(e)}),(()=>{this.emit(FormEvents.SUBMIT_END),this.submitButtonElement.disabled=!1,this.submitButtonElement.classList.remove("button--pending")}))}else if(this.formElement.matches(".simple-form")){const e=this.formElement.querySelector(".simple-form__inner");e.classList.remove("shake"),requestAnimationFrame((()=>e.classList.add("shake"))),e.querySelector("input").focus()}else{const e=this.formElement.querySelector(".pristine-item--invalid"),t=e?.closest(".modal");t?t.scrollTo({top:e.offsetTop,behavior:"smooth"}):window.scrollTo({top:e.offsetTop-this.siteHeaderElement.offsetHeight,behavior:"smooth"}),e.querySelector("input, textarea").focus(),e.classList.remove("shake"),requestAnimationFrame((()=>e.classList.add("shake")))}})),this.formElement.addEventListener("reset",(()=>{setTimeout((()=>{this.textFieldControlElements?.forEach((e=>{e.dispatchEvent(inputEvent)})),this.validator.reset()}),0)}))}}class ModalForm extends Modal{constructor(e){super(e),this.formElement=e.querySelector(".modal-form"),this.form=new Form(this.formElement)}setHandlers=(e,t)=>{this.form.setHandlers((()=>{e(),this.modalElement.close()}),(()=>{t()}))}}class ModalEntry extends Modal{RESEND_TIME_INTERVAL=7;timer=0;RUSSIAN_PHONE_NUMBER_LENGTH=11;ERROR_MESSAGE_DURATION=5e3;constructor(e){super(e),this.codeFormElement=e.querySelector(".modal-entry__form--code"),this.phoneFieldElement=this.codeFormElement.querySelector(".modal-entry__phone-field .text-field__control"),this.phoneFieldMask=null,this.phoneFormatTogglerElement=this.codeFormElement.querySelector(".modal-entry__phone-format-toggler"),this.isRussianPhoneFormat=!0,this.loginFormElement=e.querySelector(".modal-entry__form--login"),this.currentPhoneTextElement=this.loginFormElement.querySelector("[data-current-phone-text]"),this.resendElement=this.loginFormElement.querySelector(".modal-entry__resend"),this.resendTimerElement=this.resendElement.querySelector(".modal-entry__resend-timer"),this.resendButtonElement=this.resendElement.querySelector(".modal-entry__resend-button"),this.loginFormSubmitButtonElement=this.loginFormElement.querySelector(".modal-entry__submit-button"),this.codeFieldsWrapperElement=this.loginFormElement.querySelector(".modal-entry__code-fields"),this.codeFieldElements=Array.from(this.codeFieldsWrapperElement.querySelectorAll(".modal-entry__code-field .text-field__control")),this.init()}showCodeFormErrorMessage=()=>{this.codeFormElement.classList.add("modal-entry__form--error"),setTimeout((()=>{this.codeFormElement.classList.remove("modal-entry__form--error")}),this.ERROR_MESSAGE_DURATION)};showLoginFormErrorMessage=()=>{this.loginFormElement.classList.add("modal-entry__form--error"),setTimeout((()=>{this.loginFormElement.classList.remove("modal-entry__form--error")}),this.ERROR_MESSAGE_DURATION)};enableRussianPhoneFormat=()=>{this.phoneFieldElement.placeholder="+7 (_ _ _) _ _ _-_ _-_ _",this.phoneFieldMask?.destroy(),this.phoneFieldMask=new IMask(this.phoneFieldElement,{mask:"+{7} (000) 000-00-00"}),this.isRussianPhoneFormat=!0};disableRussianPhoneFormat=()=>{this.phoneFieldMask?.destroy(),this.phoneFieldElement.placeholder="",this.phoneFieldMask=new IMask(this.phoneFieldElement,{mask:"00000000000000000"}),this.isRussianPhoneFormat=!1};onPhoneFormatTogglerClick=()=>{this.isRussianPhoneFormat?(this.disableRussianPhoneFormat(),this.phoneFormatTogglerElement.querySelector(".button__text").textContent="Российский номер"):(this.enableRussianPhoneFormat(),this.phoneFormatTogglerElement.querySelector(".button__text").textContent="Другой формат номера")};validatePhoneField=()=>!!this.phoneFieldElement.value&&!(this.isRussianPhoneFormat&&this.phoneFieldMask.unmaskedValue.length<this.RUSSIAN_PHONE_NUMBER_LENGTH);validateCodeFields=()=>this.codeFieldElements.every((e=>e.value));onCodeFieldsWrapperInput=()=>{this.validateCodeFields()?(this.loginFormSubmitButtonElement.disabled=!1,this.loginFormSubmitButtonElement.classList.remove("button--disabled")):(this.loginFormSubmitButtonElement.disabled=!0,this.loginFormSubmitButtonElement.classList.add("button--disabled"))};startTimer=()=>{if(this.timer<=0){this.timer=this.RESEND_TIME_INTERVAL,this.resendTimerElement.textContent=this.timer,this.resendElement.classList.add("modal-entry__resend--waiting");const e=setInterval((()=>{this.timer--,this.resendTimerElement.textContent=this.timer,this.timer<=0&&(clearInterval(e),this.resendElement.classList.remove("modal-entry__resend--waiting"))}),1e3)}};switchStep=e=>{1===e?(this.codeFormElement.classList.remove("modal-entry__form--hidden"),this.loginFormElement.classList.add("modal-entry__form--hidden")):2===e&&(this.startTimer(),this.currentPhoneTextElement.textContent=this.phoneFieldElement.value,this.codeFormElement.classList.add("modal-entry__form--hidden"),this.loginFormElement.classList.remove("modal-entry__form--hidden"))};reset=()=>{this.codeFormElement.reset(),this.loginFormElement.reset(),this.loginFormSubmitButtonElement.disabled=!0,this.loginFormSubmitButtonElement.classList.add("button--disabled"),this.switchStep(1)};init=()=>{this.enableRussianPhoneFormat(),this.phoneFormatTogglerElement.addEventListener("click",this.onPhoneFormatTogglerClick),this.resendButtonElement.addEventListener("click",(e=>{e.preventDefault(),this.startTimer()})),this.codeFieldElements.forEach(((e,t)=>{e.addEventListener("input",(()=>{e.value=e.value.slice(0,1),e.value.length&&t<+this.codeFieldElements.length-1&&this.codeFieldElements[t+1].focus()})),e.addEventListener("keydown",(i=>{isBackspaceEvent(i)&&!e.value&&t>0&&this.codeFieldElements[t-1].focus()}))})),this.codeFieldsWrapperElement.addEventListener("input",this.onCodeFieldsWrapperInput),this.onOpenerClick=()=>{this.reset()}}}class BirthDateModalForm extends Modal{constructor(e,t){super(e),this.formElement=e.querySelector(".birth-date-modal-form"),this.dayFieldElement=this.formElement.querySelector(".birth-date-modal-form__item-day input"),this.monthFieldElement=this.formElement.querySelector(".birth-date-modal-form__item-month .select__control"),this.yearFieldElement=this.formElement.querySelector(".birth-date-modal-form__item-year input"),this.submitButtonElement=this.formElement.querySelector(".birth-date-modal-form__submit-button"),this.backButtonElement=this.formElement.querySelector(".birth-date-modal-form__back-button"),this.actionUrl=this.formElement.action,this.infoModal=t,this.form=new PubSub,this.form.formElement=this.formElement,this.step=1,this.init()}validate=()=>this.dayFieldElement.value&&this.dayFieldElement.value<=31&&this.monthFieldElement.value&&this.yearFieldElement.value&&+this.yearFieldElement.value>1900&&+this.yearFieldElement.value<=(new Date).getFullYear();disableSubmitButton=()=>{this.submitButtonElement.classList.add("button--disabled"),this.submitButtonElement.disabled=!0};enableSubmitButton=()=>{this.submitButtonElement.classList.remove("button--disabled"),this.submitButtonElement.disabled=!1};setSumbitButtonState=()=>{this.validate()?this.enableSubmitButton():this.disableSubmitButton()};switchStep=e=>{1===e?(this.formElement.classList.remove("birth-date-modal-form--step-2"),this.step=1):2===e&&(this.formElement.classList.add("birth-date-modal-form--step-2"),this.step=2)};updateBlockOnPage=()=>{const e=document.querySelector(".profile-form__birth-date"),t=e.querySelector(".profile-form__birth-date-label"),i=e.querySelector(".profile-form__birth-date-button"),o=createElementByString('\n      <button class="profile-form__birth-data-info-button info-button" type="button" data-modal-opener="birth-date-info">\n        <span class="visually-hidden">Изменить дату рождения</span>\n      </button>\n    ');this.infoModal.initOpener(o);const s=createElementByString(`\n      <p class="profile-form__birth-date-value">\n        <span>${this.dayFieldElement.value}</span>\n        <span>${MONTHS_NAMES[this.monthFieldElement.value-1]}</span>\n        <span>${this.yearFieldElement.value}</span>\n      </p>\n    `);t.insertAdjacentElement("afterend",o),i.replaceWith(s)};onFormInput=e=>{this.setSumbitButtonState()};onFormSubmit=e=>{if(e.preventDefault(),1===this.step)this.switchStep(2);else if(2===this.step){this.form.emit(FormEvents.SUBMIT_START),this.submitButtonElement.disabled=!0,this.submitButtonElement.classList.add("button--pending");const t=new FormData(e.target);sendData(this.actionUrl,t,(e=>{this.close(),showNotification({text:"Данные профиля<br> успешно сохранены",status:"success"}),this.updateBlockOnPage()}),(e=>{const t=showAlert({heading:"Не получилось сохранить дату",button:{text:"Попробовать еще раз"}});initFormResending(this.form,t)}),(()=>{this.form.emit(FormEvents.SUBMIT_END),this.submitButtonElement.disabled=!1,this.submitButtonElement.classList.remove("button--pending")}))}};onBackButtonClick=()=>{this.switchStep(1)};init=()=>{this.setSumbitButtonState(),this.formElement.addEventListener("change",this.onFormInput),this.formElement.addEventListener("input",this.onFormInput),this.formElement.addEventListener("submit",this.onFormSubmit),this.backButtonElement.addEventListener("click",this.onBackButtonClick),this.onOpenerClick=()=>{this.switchStep(1)}}}class CheckoutForm extends Form{deliveryCompanyStateClasses={sdek:"checkout-form--delivery-company_sdek",post:"checkout-form--delivery-company_post",selfPickup:"checkout-form--delivery-company_self-pickup"};deliveryMethodStateClasses={point:"checkout-form--delivery-method_point",courier:"checkout-form--delivery-method_courier"};constructor(e){super(e),this.formElement=e,this.regionFieldElement=this.formElement.querySelector('[data-name="region"]'),this.deliveryCompanyButtonsWrapper=this.formElement.querySelector(".checkout-form__delivery-company"),this.phoneFieldElement=this.formElement.querySelector(".checkout-form__phone-field .text-field__control"),this.pickupPointFieldWrapperElement=this.formElement.querySelector(".checkout-form__pick-up-point-field"),this.regionModalElement=document.querySelector('[data-modal="region-form"]'),this.regionFormElement=this.regionModalElement.querySelector(".modal-form"),this.regionFormCountryFieldElement=this.regionFormElement.querySelector(".modal-form__country-select select"),this.regionFormCountrySelect=initSelect(this.regionFormCountryFieldElement),this.regionFormCountryOptionElements=Array.from(this.regionFormElement.querySelectorAll(".modal-form__country-select option")),this.regionFormCityFieldElement=this.regionFormElement.querySelector(".modal-form__city-field .text-field__control"),this.regionFormSubmitButtonElement=this.regionFormElement.querySelector(".modal-form__submit-button"),this.regionModal=new Modal(this.regionModalElement),this.addressModalElement=document.querySelector('[data-modal="address-form"]'),this.addressFormElement=this.addressModalElement.querySelector(".modal-form"),this.addressFormCountryFieldElement=this.addressFormElement.querySelector(".modal-form__country-select select"),this.addressFormCountrySelect=initSelect(this.addressFormCountryFieldElement),this.addressFormCountryOptionElements=Array.from(this.addressFormElement.querySelectorAll(".modal-form__country-select option")),this.addressFormCityFieldElement=this.addressFormElement.querySelector(".modal-form__city-field .text-field__control"),this.addressModal=new Modal(this.addressModalElement),this.sdekModalElement=document.querySelector('[data-modal="sdek-sdek"]'),this.sdekModal=new Modal(this.sdekModalElement),this.sdekModal.initOpener(this.pickupPointFieldWrapperElement),this.postModalElement=document.querySelector('[data-modal="sdek-post"]'),this.postModal=new Modal(this.postModalElement),this.postModal.initOpener(this.pickupPointFieldWrapperElement),this.init()}getSelectedOption=(e,t)=>t.find((t=>t.value===e.value));setDeliveryCompanySdekState=()=>{this.formElement.classList.remove(this.deliveryCompanyStateClasses.post),this.formElement.classList.remove(this.deliveryCompanyStateClasses.selfPickup),this.formElement.classList.add(this.deliveryCompanyStateClasses.sdek)};setDeliveryCompanyPostState=()=>{this.formElement.classList.remove(this.deliveryCompanyStateClasses.sdek),this.formElement.classList.remove(this.deliveryCompanyStateClasses.selfPickup),this.formElement.classList.add(this.deliveryCompanyStateClasses.post)};setDeliveryCompanySelfPickupState=()=>{this.formElement.classList.remove(this.deliveryCompanyStateClasses.sdek),this.formElement.classList.remove(this.deliveryCompanyStateClasses.post),this.formElement.classList.add(this.deliveryCompanyStateClasses.selfPickup)};setDeliveryMethodCourierState=()=>{this.formElement.classList.remove(this.deliveryMethodStateClasses.point),this.formElement.classList.add(this.deliveryMethodStateClasses.courier)};setDeliveryMethodPointState=()=>{this.formElement.classList.add(this.deliveryMethodStateClasses.point),this.formElement.classList.remove(this.deliveryMethodStateClasses.courier)};onFormChange=e=>{const t=e.target.closest(".checkout-form__delivery-company"),i=e.target.closest(".checkout-form__delivery-methods");if(t){switch(e.target.dataset.title){case"SDEK":this.setDeliveryCompanySdekState(),this.pickupPointFieldWrapperElement.dataset.modalOpener="sdek-sdek";break;case"POST":this.setDeliveryCompanyPostState(),this.pickupPointFieldWrapperElement.dataset.modalOpener="sdek-post";break;case"PICKUP":this.setDeliveryCompanySelfPickupState()}}else if(i){switch(e.target.dataset.type){case"courier":this.setDeliveryMethodCourierState();break;case"point":this.setDeliveryMethodPointState()}}else;};init=()=>{new IMask(this.phoneFieldElement,{mask:"[+]00000000000000000"}),this.formElement.addEventListener("change",this.onFormChange)}}class ProfileForm extends Form{constructor(e,t){super(e,t),this.formElement=e,this.countryFieldElement=this.formElement.querySelector(".profile-form__country select"),this.countrySelect=initSelect(this.countryFieldElement)}}class Product{CART_NOTIFICATION_DURATION=3e3;constructor(e){this.formElement=e.querySelector(".product__inner"),this.cartNotificationElement=document.querySelector(".cart-notification"),this.counterElement=e.querySelector(".product__cart-counter .counter__control"),this.counterButtonMinusElement=e.querySelector(".product__cart-counter .counter__button--minus"),this.colorSectionElement=e.querySelector(".product__color-section"),this.sizeSectionElement=e.querySelector(".product__size-section"),this.checkSelectedColor=()=>!0,this.checkSelectedSize=()=>!0,this.form=null,this.init()}initColorButtons=()=>{const e=this.colorSectionElement.querySelector(".product__color-value");this.colorSectionElement.querySelector(".product__colors").addEventListener("change",(t=>{const i=t.target.closest(".color").querySelector(".color__title").textContent;e.textContent=i}))};initColors=()=>{this.colorSectionElement&&(this.colorModalElement=document.querySelector('[data-modal="color"]'),this.colorButtonElements=Array.from(productElement.querySelectorAll(".color__control")),this.colorModalFormElement=this.colorModalElement.querySelector(".modal-color"),this.colorModalButtonElements=Array.from(this.colorModalFormElement.querySelectorAll(".color__control")),this.colorModalSubmitButtonElement=this.colorModalFormElement.querySelector(".modal-color__button"),this.colorModal=null,this.lockColorModalSubmitButton=()=>{this.colorModalSubmitButtonElement.disabled=!0,this.colorModalSubmitButtonElement.classList.add("button--disabled")},this.unlockColorModalSubmitButton=()=>{this.colorModalSubmitButtonElement.disabled=!1,this.colorModalSubmitButtonElement.classList.remove("button--disabled")},this.checkSelectedColorInModalForm=()=>this.colorModalButtonElements.some((e=>e.checked)),this.setColorModalSubmitButtonState=()=>{this.checkSelectedColorInModalForm()?this.unlockColorModalSubmitButton():this.lockColorModalSubmitButton()},this.onColorModalFormChange=e=>{this.setColorModalSubmitButtonState();this.colorButtonElements.find((t=>t.value===e.target.value)).checked=!0},this.checkSelectedColor=()=>this.colorButtonElements.some((e=>e.checked)),this.openColorModal=()=>{this.colorModal.open()},this.closeColorModal=()=>{this.colorModal.close()},this.colorModal=new Modal(this.colorModalElement),this.colorModalFormElement.addEventListener("change",this.onColorModalFormChange),this.initColorButtons())};initSizes=()=>{this.sizeSectionElement&&(this.sizeModalElement=document.querySelector('[data-modal="size"]'),this.sizeCheckboxElements=Array.from(productElement.querySelectorAll(".size-buttons__control")),this.sizeModalFormElement=this.sizeModalElement.querySelector(".modal-size"),this.sizeModalCheckboxElements=Array.from(this.sizeModalFormElement.querySelectorAll(".size-buttons__control")),this.sizeModalSubmitButtonElement=this.sizeModalFormElement.querySelector(".modal-size__button"),this.sizeModal=null,this.lockSizeModalSubmitButton=()=>{this.sizeModalSubmitButtonElement.disabled=!0,this.sizeModalSubmitButtonElement.classList.add("button--disabled")},this.unlockSizeModalSubmitButton=()=>{this.sizeModalSubmitButtonElement.disabled=!1,this.sizeModalSubmitButtonElement.classList.remove("button--disabled")},this.checkSelectedSizeInModalForm=()=>this.sizeModalCheckboxElements.some((e=>e.checked)),this.setSizeModalSubmitButtonState=()=>{this.checkSelectedSizeInModalForm()?this.unlockSizeModalSubmitButton():this.lockSizeModalSubmitButton()},this.onSizeModalFormChange=e=>{this.setSizeModalSubmitButtonState();this.sizeCheckboxElements.find((t=>t.value===e.target.value)).checked=!0},this.checkSelectedSize=()=>this.sizeCheckboxElements.some((e=>e.checked)),this.openSizeModal=()=>{this.sizeModal.open()},this.closeSizeModal=()=>{this.sizeModal.close()},this.sizeModal=new Modal(this.sizeModalElement),this.sizeModalFormElement.addEventListener("change",this.onSizeModalFormChange))};setCounterValue=e=>{const t=+this.counterElement.min;this.counterElement.value=e,this.counterButtonMinusElement.disabled=+this.counterElement.value<=t};setAddedToCartView=()=>{productElement.classList.add("product--in-cart")};setDefaultView=()=>{productElement.classList.remove("product--in-cart")};showCartNotification=()=>{this.cartNotificationElement.show(),setTimeout((()=>{this.cartNotificationElement.close()}),this.CART_NOTIFICATION_DURATION)};init(){this.initColors(),this.initSizes(),this.formElement.addEventListener("change",(e=>{const t=e.target.classList.contains("color__control"),i=e.target.classList.contains("size-buttons__control");(t||i)&&(this.setDefaultView(),this.setCounterValue(1))}))}}class Cart{constructor(e){this.siteHeaderElement=document.querySelector(".page__site-header"),this.cartElement=e,this.formElement=this.cartElement.querySelector(".cart__form"),this.init()}toggleFormFooterStickiness=()=>{if(laptopWidthMediaQueryList.matches)return;const e=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight),t=document.documentElement.clientHeight+window.scrollY>=e;this.formFooterElement.classList.toggle("cart-form__footer--sticked",!t)};setPageBottomIndent=()=>{if(laptopWidthMediaQueryList.matches)document.body.style.paddingBottom=0;else{const e=parseFloat(getComputedStyle(this.formFooterElement).bottom);document.body.style.paddingBottom=`${this.formFooterElement.offsetHeight+e}px`}};onWindowResize=debounce(this.setPageBottomIndent,500);onWindowScroll=throttle(this.toggleFormFooterStickiness,100);onReceivingMethodSectionChange=e=>{"delivery"===e.target.dataset.value?(this.receivingMethodSectionElement.insertAdjacentElement("afterend",this.deliverySectionElement),this.form.validator.reset(),this.form.validator.init()):(this.deliverySectionElement.remove(),this.form.validator.reset(),this.form.validator.init())};init(){this.formElement&&(this.formFooterElement=this.formElement.querySelector(".cart-form__footer"),this.form=new Form(this.formElement),this.productsList=this.formElement.querySelector(".cart-form__products-list"),this.deliverySectionElement=this.formElement.querySelector("[data-delivery-section]"),this.receivingMethodSectionElement=this.formElement.querySelector("[data-receiving-method-section]"),this.deliverySectionElement.querySelectorAll(".text-field").forEach(initTextField),this.deliverySectionElement.remove(),this.form.validator.init(),this.setPageBottomIndent(),this.toggleFormFooterStickiness(),window.addEventListener("resize",this.onWindowResize),window.addEventListener("scroll",this.onWindowScroll),this.receivingMethodSectionElement.addEventListener("change",this.onReceivingMethodSectionChange))}}class Taber{constructor(e){this.taberElement=e,this.init()}switchTab=(e,t,i)=>{if(e){e.ariaSelected=null,e.tabIndex=-1,e.classList.remove("taber__tab--active");const t=this.tabElements.indexOf(e);this.panelElements[t].classList.add("taber__panel--hidden")}i||t.focus(),t.tabIndex=0,t.ariaSelected=!0,t.classList.add("taber__tab--active");const o=this.tabElements.indexOf(t);this.panelElements[o].classList.remove("taber__panel--hidden")};openStartTab=()=>{const e=window.location.hash,t=this.tabElements.find((t=>t.hash===e));this.switchTab(null,t||this.tabElements[0],!0)};onTaberListClick=e=>{e.preventDefault();const t=e.target.closest(".taber__tab");if(!t)return;const i=this.listElement.querySelector("[aria-selected]");t!==i&&this.switchTab(i,t)};onTaberListKeydown=e=>{const t=this.tabElements.indexOf(e.target);if(isDownArrowEvent(e)||isLeftArrowEvent(e)||isRightArrowEvent(e))if(e.preventDefault(),isDownArrowEvent(e))this.panelElements[t].focus();else{const i=isLeftArrowEvent(e)?t-1:t+1;if(!this.tabElements[i])return;this.switchTab(e.target,this.tabElements[i])}};init(){this.id=this.taberElement.id,this.listElement=this.taberElement.querySelector(".taber__list"),this.tabElements=Array.from(this.listElement.querySelectorAll(".taber__tab")),this.panelElements=this.taberElement.querySelectorAll(".taber__panel"),this.listElement.setAttribute("role","tablist"),this.tabElements.forEach(((e,t)=>{e.role="tab",e.id=`${this.id}-tab-${t+1}`,e.href=`#${this.id}-panel-${t+1}`,e.tabIndex=-1,e.parentNode.role="presentation"})),this.panelElements.forEach(((e,t)=>{e.role="tabpanel",e.id=`${this.id}-panel-${t+1}`,e.tabIndex=-1,e.setAttribute("aria-labelledby",this.tabElements[t].id),e.classList.add("taber__panel--hidden")})),this.openStartTab(),this.listElement.addEventListener("click",this.onTaberListClick),this.listElement.addEventListener("keydown",this.onTaberListKeydown)}}class Reviews{constructor(e){this.reviewsElement=e,this.listElement=e.querySelector(".reviews-list"),this.reviewsWrapperElement=this.listElement.querySelector(".reviews-list__items"),this.reviewPhotosModalElement=document.querySelector('[data-modal="review-photos"]'),this.reviewPhotosModal=null,this.reviewPhotosModalSliderElement=null,this.reviewPhotosModalSlider=null,this.init()}updateReviewsTextWrappersList=()=>{this.reviewTextWrapperElements=this.listElement.querySelectorAll(".review__text-wrapper")};setReviewTextWrapperMode=e=>{const t=e.classList.contains("review__text-wrapper--clipped");e.classList.add("review__text-wrapper--clipped");const i=e.querySelector(".review__text");i.scrollHeight-i.offsetHeight>5?e.classList.add("review__text-wrapper--clippable"):e.classList.remove("review__text-wrapper--clippable"),t||e.classList.remove("review__text-wrapper--clipped")};setReviewsTextWrappersMode=()=>{this.reviewTextWrapperElements.forEach(this.setReviewTextWrapperMode)};initReviewSlider=e=>{const t=e.querySelector(".review__slider");t&&new Swiper(t,{slidesPerView:"auto",spaceBetween:10,grabCursor:!0})};createReviewElement=e=>{const t=new Date(e.date).toLocaleDateString("ru-RU"),i=e.photos?.map((e=>`\n      <li class="review__slider-item swiper-slide">\n        <picture class="review__slider-image-wrapper media media--cover media--position_top skeleton">\n          <img class="media__image" src="${e}" width="102" height="128" alt="" loading="lazy">\n        </picture>\n      </li>\n    `)).join("");return createElementByString(`\n      <li class="reviews-list__item">\n        <article class="review">\n          <footer class="review__footer">\n            <p class="review__author">${e.author}</p>\n            <time class="review__date" datetime="${e.date}">${t}</time>\n          </footer>\n          <div class="review__text-wrapper review__text-wrapper--clipped">\n            <blockquote class="review__text">${e.text}</blockquote>\n            <button class="review__toggle-button" type="button">\n              <span class="review__toggle-button-text">Скрыть</span>\n              <span class="review__toggle-button-text-clipped">Читать полностью</span>\n            </button>\n          </div>\n          <div class="review__slider-wrapper">\n            <div class="review__slider swiper">\n              <ul class="review__slider-list swiper-wrapper">\n                ${i}\n              </ul>\n          </div>\n        </article>\n      </li>\n    `)};renderReviews=e=>{const t=e.map(this.createReviewElement);this.reviewsWrapperElement.append(...t);for(const e of t)initSkeletons(e),this.initReviewSlider(e),this.setReviewTextWrapperMode(e.querySelector(".review__text-wrapper"));this.updateReviewsTextWrappersList()};onWindowResize=debounce(this.setReviewsTextWrappersMode,500);createReviewPhotosModalSlider=e=>createElementByString(`\n      <div class="gallery-slider modal__gallery-slider">\n        <div class="gallery-slider__slider swiper">\n          <ul class="gallery-slider__list swiper-wrapper">\n            ${e.map((e=>`\n              <li class="gallery-slider__item swiper-slide">\n                <picture class="gallery-slider__image-wrapper media media--cover media--position_top skeleton">\n                  <img class="gallery-slider__image media__image" src="${e}" width="622" height="786" alt="" loading="lazy">\n                </picture>\n              </li>\n            `)).join("")}\n          </ul>\n        </div>\n        <div class="slider-arrows gallery-slider__arrows slider-arrows--big">\n          <ul class="slider-arrows__list">\n            <li class="slider-arrows__item">\n              <button class="slider-arrows__button slider-arrows__button--prev" type="button">\n                <span class="visually-hidden">Предыдущий</span>\n              </button>\n            </li>\n            <li class="slider-arrows__item">\n              <button class="slider-arrows__button slider-arrows__button--next" type="button">\n                <span class="visually-hidden">Следующий</span>\n              </button>\n            </li>\n          </ul>\n        </div>\n      </div>\n    `);updateReviewModalSlider=e=>{this.reviewPhotosModalSlider?.destroy(),this.reviewPhotosModalSliderElement?.remove(),this.reviewPhotosModalSliderElement=this.createReviewPhotosModalSlider(e),this.reviewPhotosModalElement.querySelector(".modal__inner").append(this.reviewPhotosModalSliderElement),initSkeletons(this.reviewPhotosModalSliderElement),this.reviewPhotosModalSlider=initGallerySlider(this.reviewPhotosModalSliderElement)};onListClick=e=>{const t=e.target.closest(".review__slider-item"),i=e.target.closest(".review__toggle-button");if(t){const e=Array.from(t.parentElement.querySelectorAll(".review__slider-item")),i=e.map((e=>e.querySelector("img").src));if(!i.length)return;const o=e.indexOf(t);this.updateReviewModalSlider(i),this.reviewPhotosModal.open(),this.reviewPhotosModalSlider.slideTo(o,0)}if(i){i.closest(".review__text-wrapper").classList.toggle("review__text-wrapper--clipped")}};init(){this.updateReviewsTextWrappersList(),this.setReviewsTextWrappersMode(),this.reviewsWrapperElement.querySelectorAll(".review__slider-wrapper").forEach(this.initReviewSlider),window.addEventListener("resize",this.onWindowResize),this.reviewPhotosModal=new Modal(this.reviewPhotosModalElement),this.listElement.addEventListener("click",this.onListClick)}}class Video{constructor(e){this.videoElement=e,this.posterElement=e.querySelector(".video__poster"),this.playButtonWrapperElement=e.querySelector(".video__play-button-wrapper"),this.playButtonElement=e.querySelector(".video__play-button"),this.playerElement=e.querySelector(".video__player"),this.init()}play=()=>{this.playerElement.play(),this.playButtonWrapperElement.classList.add("video__play-button-wrapper--hidden"),this.posterElement.classList.add("video__poster--hidden")};init(){this.playButtonElement.addEventListener("click",(()=>{this.play()})),this.playerElement.addEventListener("ended",(()=>{this.playButtonWrapperElement.classList.remove("video__play-button-wrapper--hidden"),this.posterElement.classList.remove("video__poster--hidden")}))}}class Catalog{constructor(e,t){this.catalogElement=e,this.pageScrollWrapperElement=t,this.productsWrapperElement=e.querySelector(".products-list__items"),this.sortingElement=e.querySelector(".catalog__sorting"),this.init()}createProductListItemElement=e=>{const t=e.new||e.sale?`\n      <div class="product-badges product-card__badges product-badges--light">\n        <ul class="product-badges__list">\n          ${e.sale?'<li class="product-badges__item">sale</li>':""}\n          ${e.new?'<li class="product-badges__item">new</li>':""}\n        </ul>\n      </div>\n    `:"",i=e.sizes?`\n      <ol class="product-card__sizes">\n        ${e.sizes.map((e=>`\n          <li class="product-card__sizes-item ${e.disabled?"":"product-card__sizes-item--active"}">\n            ${e.title}\n          </li>\n        `)).join("")}\n      </ol>\n    `:"",o=e.colors?`\n      <div class="product-card__colors">\n        <ul class="product-card__colors-list">\n          ${e.colors.map((e=>`\n            <li class="product-card__colors-item ${e.disabled?"product-card__colors-item--disabled":""}">\n              <img class="product-card__colors-image" src="${e.src}" width="28" height="28" alt="${e.title}">\n            </li>\n          `)).join("")}\n        </ul>\n        <p class="product-card__colors-counter product-card__colors-counter--hidden"></p>\n      </div>\n    `:"";return createElementByString(`\n      <li class="products-list__item">\n        <article class="product-card">\n          <div class="product-card__link-wrapper">\n            <h2 class="product-card__heading">\n              <a class="product-card__link" href="${e.link}">${e.title}</a>\n            </h2>\n            <div class="product-card__images">\n              <picture class="product-card__image-wrapper-primary media media--cover media--position_top skeleton">\n                <img class="product-card__image media__image" src="${e.image}" width="365" height="563" alt="" loading="lazy">\n              </picture>\n              <picture class="product-card__image-wrapper-secondary media media--cover media--position_top skeleton">\n                <img class="product-card__image media__image" src="${e.image2}" width="365" height="563" alt="" loading="lazy">\n              </picture>\n              ${t}\n              ${o}\n              ${i}\n            </div>\n          </div>\n          <div class="product-card__price-wrapper">\n            ${e.oldPrice?`<s class="product-card__price product-card__price--old">${e.oldPrice.toLocaleString("ru-RU")} ₽</s>`:""}\n            ${e.price?`<p class="product-card__price">${e.price.toLocaleString("ru-RU")} ₽</p>`:""}\n          </div>\n          ${e.installments?`<p class="product-card__installments">Долями по ${e.installments.toLocaleString("ru-RU")} ₽</p>`:""}\n        </article>\n      </li>\n    `)};renderProducts=e=>{const t=e.map(this.createProductListItemElement);this.productsWrapperElement.append(...t);for(const e of t)initSkeletons(e),setProductCardColorsCounter(e)};init=()=>{initCatalogFilter(this.catalogElement,this.pageScrollWrapperElement),initCatalogSorting(this.sortingElement)}}class Celebrities{constructor(e){this.celebritiesElement=e,this.celebritiesWrapperElement=this.celebritiesElement.querySelector(".celebrities-list__items")}createCelebritiesListItemElement=e=>createElementByString(`\n      <li class="celebrities-list__item">\n        <picture class="celebrities-list__image-wrapper skeleton">\n          <img class="celebrities-list__image" src=${e.image} width="750" height="1030" alt=${e.title} loading="lazy">\n        </picture>\n        <p class="celebrities-list__title">${e.title}</p>\n      </li>\n    `);renderCelebrities=e=>{const t=e.map(this.createCelebritiesListItemElement);this.celebritiesWrapperElement.append(...t);for(const e of t)initSkeletons(e)}}let activeButtonElement=null;function onDocumentClickWhileArticlePhotosButtonExpanded(e){!e.target.closest(".article__photos button")&&activeButtonElement&&(activeButtonElement.ariaExpanded="false",activeButtonElement=null),document.removeEventListener("click",onDocumentClickWhileArticlePhotosButtonExpanded)}function initArticlePhotos(e){e.addEventListener("click",(e=>{const t=e.target.closest(".article__photos button");if(!t)return;activeButtonElement&&activeButtonElement!==t&&(activeButtonElement.ariaExpanded="false");"true"===t.ariaExpanded?(t.ariaExpanded="false",activeButtonElement=null,document.removeEventListener("click",onDocumentClickWhileArticlePhotosButtonExpanded)):(t.ariaExpanded="true",activeButtonElement=t,document.addEventListener("click",onDocumentClickWhileArticlePhotosButtonExpanded)),e.stopPropagation()}))}function initArticleSeasons(e){const t=createElementByString('\n    <div class="seasons-slider swiper">\n      <p class="seasons-slider__pagination"></p>\n    </div>\n  '),i=e.querySelector("ul");t.append(i),i.classList.add("seasons-slider__list","swiper-wrapper");const o=i.querySelectorAll("li");o.forEach((e=>e.classList.add("seasons-slider__item","swiper-slide"))),e.append(t),new Swiper(t,{effect:"flip",speed:600,loop:!0,grabCursor:!0,pagination:{el:".seasons-slider__pagination",clickable:!0,bulletClass:"seasons-slider__pagination-button",bulletActiveClass:"seasons-slider__pagination-button--active",renderBullet:(e,t)=>`\n        <button class='${t}' type='button'>\n          ${o[e].dataset.label}\n        </button>\n      `}})}function initBrandsSlider(e){const t=e.querySelector(".brands__slider"),i=e.querySelector(".slider-arrows__button--prev"),o=e.querySelector(".slider-arrows__button--next");new Swiper(t,{slidesPerView:"auto",spaceBetween:28,grabCursor:!0,navigation:{prevEl:i,nextEl:o,disabledClass:"slider-arrows__button--disabled",lockClass:"slider-arrows__button--hidden"},breakpoints:{768:{slidesPerView:"auto",spaceBetween:60},1280:{slidesPerView:"auto",spaceBetween:103},1600:{slidesPerView:"auto",spaceBetween:144}}})}function initCatalogFilter(e,t){const i=e.querySelector(".catalog__filter-button"),o=e.querySelector(".catalog__filter-wrapper");if(!i||!o)return;const s=e.querySelector(".catalog__header"),r=o.querySelector(".catalog-filter__close-button"),n=e.querySelector(".catalog__body"),l=o.querySelectorAll(".checker__control"),a=o.querySelector(".catalog-filter__clear-button"),c=()=>{o.style.height=`${Math.min(document.documentElement.clientHeight,document.documentElement.clientHeight-s.getBoundingClientRect().bottom)}px`};function d(){e.classList.remove("catalog--filter-open"),n.removeEventListener("click",m)}function m(e){e.target.closest(".catalog__filter-wrapper")||d()}i.addEventListener("click",(()=>{e.classList.contains("catalog--filter-open")?d():(c(),e.classList.add("catalog--filter-open"),n.addEventListener("click",m))})),r.addEventListener("click",(e=>{d()})),window.addEventListener("resize",(()=>{e.classList.contains("catalog--filter-open")&&c()})),new SimpleBar(e.querySelector(".catalog-filter__sections"),{autoHide:!1}),a.addEventListener("click",(()=>{l.forEach((e=>{e.checked=!1,e.dispatchEvent(inputEvent)}))})),t.addEventListener("scroll",(()=>{e.classList.contains("catalog--filter-open")&&c()}))}function initCatalogPreviewSlider(e){const t=e.querySelector(".slider-pagination");new Swiper(e,{slidesPerView:"auto",spaceBetween:10,pagination:{el:t,type:"progressbar"},breakpoints:{390:{slidesPerView:2,spaceBetween:10},580:{slidesPerView:3,spaceBetween:10},790:{slidesPerView:4,spaceBetween:10},1280:{slidesPerView:4,spaceBetween:20}}})}function initCatalogSorting(e){function t(t){(t.target.closest(".catalog__sorting")!==e||t.target.matches(".catalog__sorting-list"))&&(t.preventDefault(),i())}function i(){e.classList.remove("catalog__sorting--open"),document.removeEventListener("click",t)}e.addEventListener("click",(o=>{if(o.target.closest(".catalog__sorting-toggle-button"))e.classList.contains("catalog__sorting--open")?i():(e.classList.add("catalog__sorting--open"),setTimeout((()=>{document.addEventListener("click",t)}),0));else{const t=o.target.closest(".catalog__sorting-link");if(!t)return;e.querySelector(".catalog__sorting-toggle-button").textContent=t.textContent,e.querySelector(".catalog__sorting-link--active")?.classList.remove("catalog__sorting-link--active"),t.classList.add("catalog__sorting-link--active"),i()}}))}function initCheckoutProductsSlider(e){new Swiper(e,{slidesPerView:"auto",spaceBetween:10,grabCursor:!0,breakpoints:{1280:{slidesPerView:"auto",spaceBetween:5}}})}function initConsumersPhotosSlider(e){const t=e.querySelector(".consumers-photos__slider"),i=e.querySelector(".slider-arrows__button--prev"),o=e.querySelector(".slider-arrows__button--next"),s=e.querySelector(".slider-pagination");return new Swiper(t,{slidesPerView:"auto",spaceBetween:10,navigation:{prevEl:i,nextEl:o,disabledClass:"slider-arrows__button--disabled",lockClass:"slider-arrows__button--hidden"},pagination:{el:s,type:"progressbar"},breakpoints:{1280:{slidesPerView:4,spaceBetween:20}}})}function initConsumersPhotos(){let e=null,t=null;const i=document.querySelector(".consumers-photos__slider-wrapper");i&&(t=Array.from(i.querySelectorAll(".consumers-photos__slider-item ")),e=initConsumersPhotosSlider(i));let o=null,s=null;const r=document.querySelector('[data-modal="consumers-photos"]');r&&(s=initGallerySlider(r.querySelector(".gallery-slider")),o=new Modal(r,{onOpenerClick:e=>{const i=e.target.closest("li");if(i&&s){const e=t.indexOf(i);s.slideTo(e,0)}}}))}function initFolds(e){e.addEventListener("click",(e=>{let{target:t}=e;const i=t.closest(".folds__button");if(!i)return;const o=i.closest(".folds__item"),s=o.querySelector(".folds__item-content-wrapper"),r=s.querySelector(".folds__item-content"),n=r.getBoundingClientRect().height;s.style.height=`${n}px`,r.style.position="absolute",setTimeout((()=>{o.classList.toggle("folds__item--open")}),20),i.ariaExpanded="true"===i.ariaExpanded?"false":"true"})),e.addEventListener("transitionend",(e=>{let{target:t}=e;const i=t.closest(".folds__item");i&&i.classList.contains("folds__item--open")&&(t.classList.contains("folds__item-content")&&(t.style.position="static"),t.classList.contains("folds__item-content-wrapper")&&setTimeout((()=>{t.style.height="auto"}),0))}))}function initGallerySlider(e){const t=e.querySelector(".gallery-slider__slider"),i=e.querySelector(".slider-arrows__button--prev"),o=e.querySelector(".slider-arrows__button--next");return new Swiper(t,{effect:"creative",creativeEffect:{prev:{shadow:!0,translate:["-20%",0,-1]},next:{translate:["100%",0,0]}},speed:500,navigation:{prevEl:i,nextEl:o,disabledClass:"slider-arrows__button--disabled",lockClass:"slider-arrows__button--hidden"},grabCursor:!0})}function initMenu(e){document.querySelector(".site-header__burger");e.addEventListenerClick}function initPageScrollbar(e){return new SimpleBar(e,{classNames:{contentEl:"page__inner"}})}function setProductCardColorsCounter(e){const t=e.querySelector(".product-card__colors-list");if(!t)return;t.className="product-card__colors-list";const i=e.querySelector(".product-card__colors-counter");i.classList.add("product-card__colors-counter--hidden");let o=t.offsetWidth;const s=parseInt(getComputedStyle(t.querySelector(".product-card__colors-item")).width),r=parseInt(getComputedStyle(t).columnGap);let n=Math.floor((o+r)/(s+r)),l=t.children.length-n;l&&(i.textContent=`+${l}`,i.classList.remove("product-card__colors-counter--hidden"),o=t.offsetWidth,n=Math.floor((o+r)/(s+r)),t.classList.add(`product-card__colors-list--max_${n}`),l=t.children.length-n,i.textContent=`+${l}`)}function setProductsListColorsCounter(e){for(const t of e.children)setProductCardColorsCounter(t)}function initProductCardColors(e){setProductsListColorsCounter(e),window.addEventListener("resize",debounce((()=>setProductsListColorsCounter(e)),500))}function initProductInfo(e){const t=t=>{e.querySelectorAll(".product-info__item--open").forEach((e=>{e!==t&&(e.classList.remove("product-info__item--open"),e.querySelector(".product-info__button").ariaExpanded="false")}))},i=()=>{const t=e.querySelector(".product-info__item"),i=t.querySelector(".product-info__button");t.classList.add("product-info__item--open"),i.ariaExpanded="true"};e.addEventListener("click",(e=>{let{target:i}=e;const o=i.closest(".product-info__button");if(!o)return;const s=o.closest(".product-info__item");laptopWidthMediaQueryList.matches&&t(s);const r=s.querySelector(".product-info__content-wrapper"),n=r.querySelector(".product-info__content"),l=n.getBoundingClientRect().height;r.style.height=`${l}px`,n.style.position="absolute",setTimeout((()=>{s.classList.toggle("product-info__item--open")}),20),o.ariaExpanded="true"===o.ariaExpanded?"false":"true"})),e.addEventListener("transitionend",(e=>{let{target:t}=e;const i=t.closest(".product-info__item");i&&i.classList.contains("product-info__item--open")&&(t.classList.contains("product-info__content")&&(t.style.position="static"),t.classList.contains("product-info__content-wrapper")&&setTimeout((()=>{t.style.height="auto"}),0))})),laptopWidthMediaQueryList.addEventListener("change",(()=>{laptopWidthMediaQueryList.matches&&(t(),i())})),i(),e.querySelectorAll(".product-info__content-wrapper").forEach((e=>{new SimpleBar(e,{autoHide:!1})}))}function initProduct(e){const t=e.querySelector(".product__slider");initProductInfo(e.querySelector(".product-info"));const i=document.querySelector('[data-modal="product-gallery"]'),o=Array.from(t.querySelectorAll(".product__slider-item")),s=Array.from(e.querySelectorAll(".product__image-wrapper, .product__video-wrapper")),r=i.querySelectorAll(".modal-gallery__list-item");new SimpleBar(i,{autoHide:!1}),new Modal(i,{onOpenerClick:e=>{let t;t=laptopWidthMediaQueryList.matches?s.indexOf(e.currentTarget):o.indexOf(e.currentTarget),setTimeout((()=>{r[t].scrollIntoView({behavior:"smooth"})}),400)}}),new Swiper(t,{effect:"creative",creativeEffect:{prev:{shadow:!0,translate:["-20%",0,-1]},next:{translate:["100%",0,0]}},speed:500,pagination:{el:".product__slider-pagination",bulletClass:"product__slider-pagination-button",bulletActiveClass:"product__slider-pagination-button--current",renderBullet:getPaginationButtonCreator(),clickable:!0}})}function initProductsCounters(e){const t=(e,t)=>{const i=+e.min;t.disabled=+e.value<=i};e.querySelectorAll(".counter").forEach((e=>{const i=e.querySelector(".counter__control"),o=e.querySelector(".counter__button--minus");t(i,o)})),e.addEventListener("click",(e=>{const i=e.target.closest(".counter__button");if(!i)return;const o=i.closest(".counter"),s=o.querySelector(".counter__control"),r=o.querySelector(".counter__button--minus");switch(!0){case i.matches(".counter__button--minus"):s.stepDown();break;case i.matches(".counter__button--plus"):s.stepUp()}t(s,r),s.dispatchEvent(inputEvent),s.dispatchEvent(changeEvent)}))}function initProducts(e){const t=e.querySelector(".products-slider"),i=e.querySelector(".slider-pagination"),o=e.querySelector(".slider-arrows__button--prev"),s=e.querySelector(".slider-arrows__button--next");new Swiper(t,{slidesPerView:"auto",spaceBetween:10,pagination:{el:i,type:"progressbar"},loop:!0,navigation:{prevEl:o,nextEl:s,disabledClass:"slider-arrows__button--disabled",lockClass:"slider-arrows__button--hidden"},breakpoints:{390:{slidesPerView:2,spaceBetween:10},580:{slidesPerView:3,spaceBetween:10},790:{slidesPerView:4,spaceBetween:10},1280:{slidesPerView:4,spaceBetween:20}}})}function initReviewsIntroPhotos(){let e=null,t=null;const i=document.querySelector(".reviews-intro__slider-wrapper");i&&(t=Array.from(i.querySelectorAll(".reviews-intro__slider-item:not(.reviews-intro__slider-item--quote)")),e=initReviewsIntroSlider(i));let o=null,s=null;const r=document.querySelector('[data-modal="reviews-intro-photos"]');if(r){const e=r.querySelector(".gallery-slider");s=initGallerySlider(e),o=new Modal(r,{onOpenerClick:e=>{const i=t.indexOf(e.currentTarget);s.slideTo(i,0)}})}}function initReviewsIntroSlider(e){const t=e.querySelector(".reviews-intro__slider"),i=e.querySelector(".slider-arrows__button--prev"),o=e.querySelector(".slider-arrows__button--next");new Swiper(t,{slidesPerView:"auto",spaceBetween:10,navigation:{prevEl:i,nextEl:o,disabledClass:"slider-arrows__button--disabled",lockClass:"slider-arrows__button--hidden"},breakpoints:{1280:{slidesPerView:4,spaceBetween:20}}})}function initSearch(e){const t=e.querySelector(".search-form__field-control"),i=e.querySelector(".search-form__field-clear-button"),o=()=>{setTimeout((()=>{i.classList.toggle("search-form__field-clear-button--hidden",!t.value)}))};o(),t.addEventListener("input",(()=>{o()})),e.addEventListener("click",(e=>{const i=e.target.closest(".search__placeholder .button");if(e.target.closest(".search-form__field-clear-button"))return t.value="",o(),t.focus(),t.dispatchEvent(inputEvent),void t.dispatchEvent(changeEvent);i&&(t.focus(),t.selectionStart=t.value.length)}))}function initSelect(e){return new Choices(e,{searchEnabled:!1,itemSelectText:"",shouldSort:!1})}function initSetSlider(e){const t=e.querySelector(".set__slider-list"),i=t.querySelectorAll(".set__slider-item");let o=null;const s=()=>{laptopWidthMediaQueryList.matches?(o?.destroy(),e.classList.remove("swiper"),t.classList.remove("swiper-wrapper"),i.forEach((e=>e.classList.remove("swiper-slide")))):(e.classList.add("swiper"),t.classList.add("swiper-wrapper"),i.forEach((e=>e.classList.add("swiper-slide"))),o=new Swiper(e,{effect:"creative",creativeEffect:{prev:{shadow:!0,translate:["-20%",0,-1]},next:{translate:["100%",0,0]}},speed:500,pagination:{el:".set__slider-pagination",bulletClass:"set__slider-pagination-button",bulletActiveClass:"set__slider-pagination-button--current",renderBullet:getPaginationButtonCreator(),clickable:!0}}))};laptopWidthMediaQueryList.addEventListener("change",s),s()}function initSet(e){const t=e.querySelector(".set__slider"),i=Array.from(t.querySelectorAll(".set__slider-item")),o=document.querySelector('[data-modal="set-gallery"]'),s=o.querySelectorAll(".modal-gallery__list-item");new SimpleBar(o,{autoHide:!1}),new Modal(o,{onOpenerClick:e=>{const t=i.indexOf(e.currentTarget);setTimeout((()=>{s[t].scrollIntoView({behavior:"smooth"})}),400)}}),initSetSlider(t)}function initShopSlider(e){const t=e.querySelector(".shop__main-slider"),i=e.querySelector(".shop__thumbnails-slider"),o=e.querySelector(".slider-arrows__button--prev"),s=e.querySelector(".slider-arrows__button--next"),r=new Swiper(i,{watchSlidesProgress:!0,slidesPerView:"auto",spaceBetween:10});new Swiper(t,{spaceBetween:10,navigation:{prevEl:o,nextEl:s,disabledClass:"slider-arrows__button--disabled",lockClass:"slider-arrows__button--hidden"},grabCursor:!0,thumbs:{swiper:r,slideThumbActiveClass:"shop__thumbnails-slider-item--active"},breakpoints:{390:{slidesPerView:"auto",spaceBetween:10},1280:{slidesPerView:4,spaceBetween:20}}})}function showAlert(e){let{heading:t,button:i={},icon:o}=e;const s=new Alert({heading:t,button:i,icon:o});return requestAnimationFrame((()=>s.open())),s}function showNotification(e){let{text:t,status:i}=e;const o=createElementByString(`\n    <dialog class="info-popup ${i&&`info-popup--${i}`}">\n      <p class="info-popup__text">${t}</p>\n    </dialog>\n  `);document.body.append(o),requestAnimationFrame((()=>o.show())),setTimeout((()=>{o.close()}),3e3),o.addEventListener("close",(()=>{setTimeout((()=>{o.remove()}),400)}))}function initSimpleFilterSlider(e){const t=e.querySelector(".simple-filter__slider"),i=e.querySelector(".slider-arrows__button--prev"),o=e.querySelector(".slider-arrows__button--next");new Swiper(t,{slidesPerView:"auto",spaceBetween:30,centeredSlides:!0,centeredSlidesBounds:!0,navigation:{prevEl:i,nextEl:o,disabledClass:"slider-arrows__button--disabled-hidden",lockClass:"slider-arrows__button--hidden"},grabCursor:!0,breakpoints:{1280:{slidesPerView:"auto",spaceBetween:40},1600:{slidesPerView:"auto",spaceBetween:60}}})}function initSiteHeader(e,t){let i=0;const o=()=>{const o=e.offsetHeight;t.scrollTop>0&&e.classList.add("site-header--sticked"),t.scrollTop>i&&t.scrollTop>o?e.classList.add("site-header--hidden"):(e.classList.remove("site-header--hidden"),0===t.scrollTop&&e.classList.remove("site-header--sticked")),i=t.scrollTop};o(),t.addEventListener("scroll",throttleAndDebounce(o,50));const s=e.querySelector(".site-header__burger"),r=()=>{e.classList.remove("site-header--menu-open"),s.ariaExpanded=!1,unlockPageScroll()};s.addEventListener("click",(()=>{"true"===s.ariaExpanded?r():(e.classList.add("site-header--menu-open"),s.ariaExpanded=!0,lockPageScroll())}));const n=e.querySelectorAll(".site-header__search-button"),l=e.querySelectorAll('[class^="site-header__search-close-button"]'),a=e.querySelector(".search-form__field-control"),c=()=>{e.classList.add("site-header--search-open"),lockPageScroll(),a.focus()},d=()=>{e.classList.remove("site-header--search-open"),unlockPageScroll()};n.forEach((e=>{e.addEventListener("click",c)})),l.forEach((e=>{e.addEventListener("click",d)}));const m=e.querySelectorAll(".site-navigation__link--opener");m.forEach((t=>{t.parentElement.addEventListener("mouseover",(()=>{laptopWidthMediaQueryList.matches&&e.classList.add("site-header--menu-open")}))})),m.forEach((t=>{t.parentElement.addEventListener("mouseout",(()=>{laptopWidthMediaQueryList.matches&&e.classList.remove("site-header--menu-open")}))})),laptopWidthMediaQueryList.addEventListener("change",(()=>{r(),d()}))}function initSiteNavigation(e){e.addEventListener("click",(e=>{if(laptopWidthMediaQueryList.matches)return;const t=e.target.closest(".site-navigation__link--opener");t&&(e.preventDefault(),t.classList.toggle("site-navigation__link--active"))}))}function initSizeChart(e){const t=e.querySelector("div");new SimpleBar(t,{autoHide:!1})}function initSkeleton(e){const t=e.querySelector("img");if(t)t.complete?e.classList.add("skeleton--loaded"):t.addEventListener("load",(()=>e.classList.add("skeleton--loaded")),{once:!0});else{const t=e.querySelector("video");t.readyState>=1?e.classList.add("skeleton--loaded"):t.addEventListener("loadeddata",(()=>e.classList.add("skeleton--loaded")),{once:!0})}}function initSkeletons(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:document).querySelectorAll(".skeleton").forEach(initSkeleton)}function initTextField(e){const t=e.querySelector(".text-field__data-list-wrapper");if(!t)return;const i=t.querySelector(".text-field__data-list"),o=()=>{const e=i.scrollHeight>i.scrollTop+i.clientHeight,o=i.scrollTop>0;t.classList.toggle("text-field__data-list-wrapper--blur-bottom",e),t.classList.toggle("text-field__data-list-wrapper--blur-top",o)};new MutationObserver((()=>{e.classList.contains("text-field--list-open")&&o()})).observe(e,{attributes:!0,attributeFilter:["class"]});new MutationObserver((()=>{o()})).observe(i,{childList:!0,subtree:!0}),i.addEventListener("scroll",o)}const laptopWidthMediaQueryList=window.matchMedia("(min-width: 1280px)"),inputEvent=new Event("input",{bubbles:!0}),changeEvent=new Event("change",{bubbles:!0}),simpleBar=initPageScrollbar(document.querySelector(".page__scroll-wrapper"));initSkeletons(),initSiteHeader(document.querySelector(".site-header"),simpleBar.getScrollElement()),initSiteNavigation(document.querySelector(".site-navigation")),document.querySelectorAll(".article__photos").forEach(initArticlePhotos),document.querySelectorAll(".article__seasons-slider-wrapper").forEach(initArticleSeasons),document.querySelectorAll(".taber").forEach((e=>new Taber(e))),document.querySelectorAll(".size-chart").forEach(initSizeChart),document.querySelectorAll(".video").forEach((e=>new Video(e))),document.querySelectorAll(".shop__slider-wrapper").forEach(initShopSlider),document.querySelectorAll(".simple-filter__slider-wrapper").forEach(initSimpleFilterSlider),document.querySelectorAll(".brands").forEach(initBrandsSlider),document.querySelectorAll(".catalog-preview .products-slider").forEach(initCatalogPreviewSlider),document.querySelectorAll(".search, .site-header__search").forEach(initSearch),document.querySelectorAll(".folds").forEach(initFolds),document.querySelectorAll(".products").forEach(initProducts),document.querySelectorAll(".product").forEach(initProduct),document.querySelectorAll('[data-modal="offer"]').forEach((e=>new Modal(e))),document.querySelectorAll('[data-modal="size-chart"]').forEach((e=>new Modal(e))),document.querySelectorAll('[data-modal="manager-contacts"]').forEach((e=>new Modal(e))),document.querySelectorAll(".set").forEach(initSet),document.querySelectorAll(".cart__form, .product__cart").forEach(initProductsCounters),document.querySelectorAll(".products-list__items, .products-slider__list").forEach(initProductCardColors),document.querySelectorAll(".birth-date-modal-form .select__control").forEach(initSelect),document.querySelectorAll(".checkout-order__products").forEach(initCheckoutProductsSlider);let subscriptionForm=null,subscriptionFormElement=document.querySelector(".subscription-form");subscriptionFormElement&&(subscriptionForm=new Form(subscriptionFormElement));let reviews=null,reviewsElement=document.querySelector(".reviews");reviewsElement&&(reviews=new Reviews(reviewsElement));let catalog=null;const catalogElement=document.querySelector(".catalog");catalogElement&&(catalog=new Catalog(catalogElement,simpleBar.getScrollElement()));let celebrities=null;const celebritiesElement=document.querySelector(".celebrities");celebritiesElement&&(celebrities=new Celebrities(celebritiesElement));let product=null,productElement=document.querySelector(".product");productElement&&(product=new Product(productElement));let modalEntry=null;const modalEntryElement=document.querySelector('[data-modal="entry"]');modalEntryElement&&(modalEntry=new ModalEntry(modalEntryElement));let checkoutForm=null;const checkoutFormElement=document.querySelector(".checkout-form");checkoutFormElement&&(checkoutForm=new CheckoutForm(checkoutFormElement));let profileForm=null;const profileFormElement=document.querySelector(".profile-form");profileFormElement&&(profileForm=new ProfileForm(profileFormElement,{resetAfterSubmit:!1}));let birthDateInfoModal=null;const birthDateInfoModalElement=document.querySelector('[data-modal="birth-date-info"]');birthDateInfoModalElement&&(birthDateInfoModal=new Modal(birthDateInfoModalElement));let birthDateModalForm=null;const birthDateModalFormElement=document.querySelector('[data-modal="birth-date"]');birthDateModalFormElement&&birthDateInfoModal&&(birthDateModalForm=new BirthDateModalForm(birthDateModalFormElement,birthDateInfoModal)),initReviewsIntroPhotos(),initConsumersPhotos(),document.querySelectorAll(".text-field").forEach(initTextField);